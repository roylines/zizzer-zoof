/*zizzer-zoof: Copyright (C) 2012-2013, Roy Lines, http://roylines.co.uk*/
var app=angular.module("app",["ngRoute","services"]),services=angular.module("services",["ngResource"]);app.config(["$routeProvider","$locationProvider","$httpProvider",function(a,b,c){b.html5Mode(!0);for(var d=["login","selling"],e=0;e<d.length;++e){var f={templateUrl:"/partial/"+d[e],controller:d[e]};a.when("/"+d[e],f)}a.otherwise({redirectTo:"/login"});var g=["$q",function(){function a(a){return a}function b(a){var b=a.status;return 401==b?(console.log("401 HERE!"),window.location="/login",void 0):void 0}return function(c){return c.then(a,b)}}];c.responseInterceptors.push(g)}]),services.factory("Items",["$resource",function(a){return a("/api/1/items/:id")}]),app.directive("fileInput",["$parse",function(){return{restrict:"EA",template:"<input class='hidden' type='file' name='image' accept='image/*' capture='camera' />",replace:!0,link:function(a,b,c){a.$watch("state",function(){"choose"==a.state&&(a.state="choosing",b[0].click())}),b.bind("change",function(b){a[c.onChange](b.target.files[0])})}}}]),app.controller("login",["$scope",function(){}]),app.controller("selling",["$scope","Items",function(a,b){a.state="idle",a.choose=function(){a.state="choose"},a.chosen=function(b){var c=new FileReader;c.onloadend=function(){a.$apply(function(){a.newImage=c.result,a.state="chosen"})},c.readAsDataURL(b)},a.forSale=b.query({status:"selling"})}]);