var app=angular.module("app",["ngRoute","services"]),services=angular.module("services",["ngResource"]);app.config(["$routeProvider","$locationProvider","$httpProvider",function(e,t,n){t.html5Mode(!0);for(var r=["selling"],o=0;o<r.length;++o){var i={title:"Zizzer-Zoof: "+r[o],templateUrl:"/partial/"+r[o],controller:r[o]};e.when("/"+r[o],i)}e.otherwise({title:"Zizzer-Zoof",templateUrl:"/partial/landing",controller:"landing"});var a=["$q",function(e){function t(e){return e}function n(t){var n=t.status;return 401==n?void(window.location="/"):e.reject(t)}return function(e){return e.then(t,n)}}];n.responseInterceptors.push(a)}]),app.run(["$location","$rootScope",function(e,t){t.$on("$routeChangeSuccess",function(e,n){t.title=n.title})}]),services.factory("Login",["$resource",function(e){return e("/api/1/login")}]),services.factory("Logout",["$resource",function(e){return e("/api/1/logout")}]),services.factory("Items",["$resource",function(e){return e("/api/1/items/:id")}]),services.factory("Users",["$resource",function(e){return e("/api/1/users")}]),app.directive("fileInput",["$parse",function(){return{restrict:"EA",template:"<input class='hidden' type='file' name='image' accept='image/*' capture='camera' />",replace:!0,link:function(e,t,n){e.$watch("state",function(){"choose"==e.state&&(e.state="choosing",t[0].click())}),t.bind("change",function(t){e[n.onChange](t.target.files[0])})}}}]),app.directive("mainFooter",[function(){return{restrict:"E",templateUrl:"/partial/footer",replace:!0}}]),app.directive("map",[function(){return{restrict:"EA",template:"<div class='map'></div>",replace:!0,link:function(e,t){var n,r=function(){if(void 0!==e.center){var r=new google.maps.LatLng(e.center.lat,e.center.lng);if(n)n.setCenter(r);else{var o={zoom:15,center:r};n=new google.maps.Map(t[0],o)}}};e.$watch("center",r,!0)}}}]),app.directive("mainNavigation",[function(){return{restrict:"E",templateUrl:"/partial/nav",replace:!0}}]),app.controller("landing",["$scope",function(){}]),app.controller("selling",["$scope","Items",function(e,t){e.state="idle",e.choose=function(){e.state="choose"},e.chosen=function(t){var n=new FileReader;n.onloadend=function(){e.$apply(function(){e.newImage=n.result,e.state="chosen"})},n.readAsDataURL(t)},e.forSale=t.query({status:"selling"})}]),app.controller("topbar",["$scope","$location","Logout",function(e,t,n){e.logout=function(){n.query(),t.path("/login")}}]);